詳しいコード内容はcode.jsに記載しております。

# 経費申請システム（Google Apps Script）

## 概要
Google Apps Script（GAS）を用いて構築した、
経費申請から承認通知までを自動化する業務支援システムです。

Google フォームからの申請をトリガーに、
承認用スプレッドシートへのデータ転記および
承認者・管理者へのメール通知を自動で実行します。

申請・承認・管理の各役割を想定し、
実務での運用を前提とした構成で設計しています。

## 設計の意図

本システムは、実務での運用を想定し、以下の点を重視して設計しています。

### フォーム入力と承認管理の分離
申請フォームと承認管理用スプレッドシートを分離することで、
誤操作や権限管理のリスクを低減し、管理対象を明確にしています。

### イベント駆動による自動処理
フォーム送信時トリガーを使用することで、
申請後の転記・通知を即時に行い、手作業による対応を不要としています。

### 部署単位での承認者判定
承認者をコード上の設定として管理することで、
組織変更時にもロジックを大幅に変更する必要がなく、設定のみで対応可能な構成としています。

### 運用を意識したデータ形式
申請日や項目順をあらかじめ整形して記録することで、
後続の確認作業や集計作業を行いやすくしています。


## 主な機能
<ul>
  <li>Google フォーム送信時の自動処理（onFormSubmitトリガー）</li>
  <li>申請データの承認用スプレッドシートへの転記</li>
  <li>申請日のフォーマット変換（YYYY年MM月DD日）</li>
  <li>所属部署に応じた承認者へのメール自動送信</li>
  <li>管理者への CC 通知による申請状況の可視化</li>
  <li>フォーム用ファイルと承認用ファイルの分離設計</li>
</ul>

## 使用技術
<ul>
  <li>Google Apps Script（GAS）</li>
  <li>Google フォーム</li>
  <li>Google スプレッドシート</li>
</ul>

## システム構成
<ol>
  <li>申請者が Google フォームから経費申請</li>
  <li>フォーム送信をトリガーに GAS が実行</li>
  <li>承認用スプレッドシートへデータを転記</li>
  <li>部署ごとに設定された承認者へメール通知</li>
  <li>管理者へ CC で同時通知</li>
</ol>

## 工夫した点
<ul>
  <li>部署ごとに承認者を切り替えられる設定構造</li>
  <li>承認用スプレッドシートを分離し、管理しやすい構成にした点</li>
  <li>実務での利用を想定し、項目順・日付形式・通知内容を整理した点</li>
</ul>

## 想定される拡張機能
<ul>
  <li>承認用スプレッドシート上での「承認」「却下」のステータス変更をトリガーとする処理</li>
  <li>上記トリガーを契機に、申請者へ承認結果（承認／却下）を通知するメールの自動送信</li>
</ul>

以上
